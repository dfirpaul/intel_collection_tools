"""
Using Shadow server to map IP whois

* Some results are dated!!

Requirements:
https://github.com/bunzen/RashlyOutlaid

"""

from RashlyOutlaid.libwhois import ASNWhois

#sample IPs
ip_list = ['192.168.10.1', '77.94.123.60', '10.7.8.185', '185.146.171.114', '172.22.51.27', '172.31.70.119', '172.20.21.151', '172.20.20.48', '178.33.236.62', '10.1.51.143', '10.100.201.10', '103.16.199.175', '103.16.199.45', '192.168.5.97', '103.30.247.26', '172.28.233.34', '210.56.28.10', '192.168.0.112', '81.133.112.133', '115.112.174.28', '192.168.52.10', '25.2.145.115', '203.229.186.5', '115.112.174.30', '180.179.25.226', '109.207.96.67', '192.168.6.128', '203.184.80.23', '192.254.187.160', '173.192.60.67', '103.16.198.28', '103.7.130.130', '185.139.239.140', '37.187.12.74', '202.43.190.8', '202.152.161.199', '182.50.132.55', '192.168.0.114', '200.14.104.191', '185.4.46.6', '192.168.1.1', '202.43.190.10', '192.168.137.254', '10.29.1.9', '192.168.1.9', '96.44.142.202', '81.19.211.254', '164.100.51.21', '2.100.200.101', '50.23.54.151', '192.168.0.0', '103.16.199.46', '103.16.198.30', '96.44.151.144', '192.168.1.4', '84.253.11.90', '202.176.216.138', '10.3.211.1', '192.168.178.34', '158.69.203.146', '192.168.137.163', '199.180.128.37', '186.148.57.28']


asnwhois = ASNWhois()


print 'getting whois..'

asnwhois.query = ip_list
asnwhois.peers = True
insert_checker = 0
for q, r in asnwhois.result.items():
    #IP, Country code, ASN, domain
    print q+','+ r.cn+','+r.asn+','+ r.domain


